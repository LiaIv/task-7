# Задание №8
# Оптимальное расписание. Ленточная стратегия/Конвейерная задача

## Задание
Для каждого варианта представлены условия для двух задач. Для каждой задачи необходимо построить расписание, выполняемое в кратчайшие сроки: 
1. Выбрать алгоритм решения задачи и обосновать свой выбор.
2. Применить выбранный алгоритм, в решении отобразить ход выполнения алгоритма с **подробными комментариями**.
3. В ответе указать длительность полученного расписания.
4. В ответе вывести полученное расписание в виде диаграммы Ганта.

### Вариант 9:
1. Имеется 8 независимых заданий, каждое из которых состоит из двух последовательных этапов, и 2 исполнителя, исполнитель 1 выполняет только первый этап задания, исполнитель 2 - только второй. Длительность заданий (по этапам): (1, 2), (5, 6), (8, 7), (5, 4), (2, 3), (3, 3), (4, 3), (2, 1).
2. Имеется 8 независимых заданий и 5 универсальных исполнителей. Прерывания задач допускаются. Длительность заданий: 4, 6, 5, 6, 8, 9, 11, 16.

## 1. Конвейерная задача
Первая задача по постановке является конвейерной задачей:
1. Количество заданий произвольно;
2. Каждое задание состоит из двух последовательных этапов, длительность которых произвольна;
3. Задания независимы;
4. Запрещены прерывания при выполнении заданий;
5. Количество работников строго 2;
6. Первый работник выполняет только первый этап каждого задания, второй работник — только второй этап каждого задания;
7. Производительность работников, размеры оплаты из труда и т.д. не учитываются;
8. Требуется построить расписание выполнения всех заданий в кратчайшие сроки.

Решим её, используя **алгоритм Джонсона**.

### Обоснование выбора алгоритма
Алгоритм Джонсона является **оптимальным** для задачи Flow Shop с двумя машинами (F2||Cmax). Он гарантирует построение расписания с минимальной общей длительностью выполнения всех заданий (makespan). Алгоритм основан на эвристическом правиле упорядочивания заданий, которое минимизирует простои второго исполнителя и обеспечивает оптимальное решение за полиномиальное время O(n log n).

### Алгоритм Джонсона
Пусть а<sub>i</sub> и b<sub>i</sub> — это длительности первого и второго 
этапов i-го задания:

---
| Этап/Задание | A | B | C | D | E | F | G | H |
|--------------|---|---|---|---|---|---|---|---|
| a (этап 1)   | 1 | 5 | 8 | 5 | 2 | 3 | 4 | 2 |
| b (этап 2)   | 2 | 6 | 7 | 4 | 3 | 3 | 3 | 1 |

### Применение алгоритма

**Шаг 1: Разбиение на группы**

Разобьём список всех заданий на две группы:
- **Первая группа:** задания, у которых а<sub>i</sub> ≤ b<sub>i</sub> (время на первом этапе меньше или равно времени на втором)
- **Вторая группа:** задания, у которых а<sub>i</sub> > b<sub>i</sub> (время на первом этапе больше времени на втором)

**Группа 1 (a ≤ b):**
- A(1, 2): 1 ≤ 2 ✓
- B(5, 6): 5 ≤ 6 ✓
- E(2, 3): 2 ≤ 3 ✓
- F(3, 3): 3 ≤ 3 ✓

**Группа 2 (a > b):**
- C(8, 7): 8 > 7 ✓
- D(5, 4): 5 > 4 ✓
- G(4, 3): 4 > 3 ✓
- H(2, 1): 2 > 1 ✓

**Итого:**
- **Группа 1:** A(1, 2), B(5, 6), E(2, 3), F(3, 3)
- **Группа 2:** C(8, 7), D(5, 4), G(4, 3), H(2, 1)

**Шаг 2: Сортировка групп**

Задания из **первой группы** сортируем в порядке **возрастания** величин а<sub>i</sub> (времени первого этапа):
- A(1, 2) → E(2, 3) → F(3, 3) → B(5, 6)

Задания из **второй группы** сортируем в порядке **убывания** величин b<sub>i</sub> (времени второго этапа):
- C(8, 7) имеет b=7
- D(5, 4) имеет b=4
- G(4, 3) и F(3, 3) имеют b=3
- H(2, 1) имеет b=1

Сортировка по убыванию b: C(7) → D(4) → G(3) → H(1)

**Упорядоченная группа 2:** C(8, 7), D(5, 4), G(4, 3), H(2, 1)

**Шаг 3: Формирование итоговой последовательности**

Согласно алгоритму Джонсона, оптимальное расписание получается, если сначала выполнить все задания из первой группы в отсортированном порядке, а затем — все задания из второй группы также в отсортированном порядке:

**Оптимальная последовательность:**
$$
A(1, 2) \rightarrow E(2, 3) \rightarrow F(3, 3) \rightarrow B(5, 6) \rightarrow C(8, 7) \rightarrow D(5, 4) \rightarrow G(4, 3) \rightarrow H(2, 1)
$$

### Построение расписания

Теперь построим расписание для обоих исполнителей, учитывая, что второй исполнитель может начать выполнение задания только после того, как первый исполнитель завершит первый этап этого задания:

| Задание | Исполнитель 1 (Этап 1) | Исполнитель 2 (Этап 2) | Комментарий |
|---------|------------------------|------------------------|-------------|
| A(1,2)  | 0 → 1                  | 1 → 3                  | Первое задание |
| E(2,3)  | 1 → 3                  | 3 → 6                  | M2 ждет окончания E на M1 |
| F(3,3)  | 3 → 6                  | 6 → 9                  | |
| B(5,6)  | 6 → 11                 | 11 → 17                | M2 ждет окончания B на M1 |
| C(8,7)  | 11 → 19                | 19 → 26                | M2 ждет окончания C на M1 |
| D(5,4)  | 19 → 24                | 26 → 30                | M2 занят до 26 |
| G(4,3)  | 24 → 28                | 30 → 33                | M2 ждет окончания D на M2 |
| H(2,1)  | 28 → 30                | 33 → 34                | Последнее задание |

**Длительность расписания: T = 34 единицы времени**

### Важное замечание о простоях

Второй исполнитель имеет простои (idle time), так как он должен ждать завершения задания на первом исполнителе:
- **Простой 9→11** (2 единицы): после завершения F на M2 (в момент 9) исполнитель 2 ждёт, пока B закончится на M1 (в момент 11)
- **Простой 17→19** (2 единицы): после завершения B на M2 (в момент 17) исполнитель 2 ждёт, пока C закончится на M1 (в момент 19)

Эти простои являются неизбежными в конвейерной задаче и показывают, что второй этап не может начаться, пока не завершён первый этап.

### Диаграмма Ганта

```mermaid
gantt
    title Диаграмма Ганта - Конвейерная задача (Алгоритм Джонсона)
    dateFormat s   
    axisFormat %S
    Начало выполнения работ : milestone, m1, 01 00:00, 0h
    section Исполнитель 1
    A         :a1, 01 00:00, 1s
    E         :a2, after a1, 2s
    F         :a3, after a2, 3s
    B         :a4, after a3, 5s
    C         :a5, after a4, 8s
    D         :a6, after a5, 5s
    G         :a7, after a6, 4s
    H         :a8, after a7, 2s
    section Исполнитель 2
    A         :b1, 01 00:00:01, 2s
    E         :b2, after b1, 3s
    F         :b3, after b2, 3s
    Простой   :crit, b4idle, after b3, 2s
    B         :b4, after b4idle, 6s
    Простой   :crit, b5idle, after b4, 2s
    C         :b5, after b5idle, 7s
    D         :b6, after b5, 4s
    G         :b7, after b6, 3s
    H         :b8, after b7, 1s
    Окончание выполнения работ : milestone, m2, 01 00:00:34, 0h
```

**Итоговая длительность конвейерной задачи: 34 единицы времени**

---

## 2. Ленточная стратегия
Вторая задача по постановке является задачей с **ленточной стратегией**:

### Постановка задачи:  
1. Количество заданий произвольно (8 заданий);  
2. Каждое задание имеет собственную длительность;  
3. Задания независимы - несколько заданий может выполняться разными исполнителями одновременно, но в каждый момент времени одно задание должно выполняться только одним исполнителем;  
4. **Разрешены прерывания** при выполнении заданий - задание, прерванное одним исполнителем, может быть продолжено другим;  
5. Количество исполнителей фиксировано (5 исполнителей);  
6. Исполнители универсальны, то есть могут выполнять любые задания;
7. Производительность работников, размеры оплаты их труда и т.д. не учитываются;
8. Требуется построить расписание выполнения всех заданий в кратчайшие сроки.

### Обоснование выбора алгоритма
Для данной задачи используется **ленточная стратегия с прерываниями**. Этот подход позволяет оптимально распределить работу между исполнителями, разрезая задания на части ("ленты") фиксированной длины. Алгоритм гарантирует, что время выполнения всех заданий не превысит максимум из двух величин: самого длинного задания и средней нагрузки на одного исполнителя.

### Исходные данные

Задания: A=4, B=6, C=5, D=6, E=8, F=9, G=11, H=16  
Количество исполнителей: k = 5

### Алгоритм:

**Шаг 1: Вычисление T<sub>max</sub>**

Необходимо выбрать наибольшую длительность T<sub>max</sub> среди заданий:

$$
T_{max} = max \{t_1, t_2, ..., t_n\} = max \{4, 6, 5, 6, 8, 9, 11, 16\} = 16
$$

**Шаг 2: Вычисление T<sub>avg</sub>**

Необходимо рассчитать среднюю продолжительность заданий для одного исполнителя T<sub>avg</sub>, то есть разделить сумму продолжительностей заданий на **количество исполнителей**:

$$
T_{avg} = \frac{\sum_{i=1}^n t_i}{k} = \frac{4 + 6 + 5 + 6 + 8 + 9 + 11 + 16}{5} = \frac{65}{5} = 13
$$

где k = 5 — количество исполнителей.

**Шаг 3: Определение T<sub>opt</sub>**

Длительность оптимального расписания T<sub>opt</sub> определяется как максимум из рассчитанных ранее средней продолжительности для исполнителя и наибольшей длительности заданий:

$$
T_{opt} = max \{T_{max}, T_{avg}\} = max \{16, 13\} = 16
$$

**Обоснование:** Расписание не может быть короче T<sub>max</sub> = 16, так как хотя бы одно задание длится 16 единиц. Также расписание не может быть короче T<sub>avg</sub> = 13, так как суммарная работа должна быть распределена между исполнителями.

**Порядок распределения:** Задания распределяются последовательно в алфавитном порядке A → B → C → D → E → F → G → H, с возможностью прерывания любого задания и продолжения его выполнения другим исполнителем.

**Шаг 4: Распределение заданий с прерываниями**

Задания в порядке **A → B → C → D → E → F → G → H** разрезаются на "ленты" длиной T<sub>opt</sub> = 16, которые распределяются по исполнителям. "Разрез ленты" может производиться внутри задания, что означает прерывание данного задания.

Распределим задания последовательно по исполнителям:

**Исполнитель 1:**
- Задание A полностью: 0 → 4 (длительность 4)
- Задание B полностью: 4 → 10 (длительность 6)
- Задание C полностью: 10 → 15 (длительность 5)
- Задание D частично: 15 → 16 (1 из 6 единиц)
- **Итого:** 16 единиц

**Исполнитель 2:**
- Задание D частично: 0 → 5 (остаток 5 единиц)
- Задание E полностью: 5 → 13 (длительность 8)
- Задание F частично: 13 → 16 (3 из 9 единиц)
- **Итого:** 16 единиц

**Исполнитель 3:**
- Задание F частично: 0 → 6 (остаток 6 единиц)
- Задание G частично: 6 → 16 (10 из 11 единиц)
- **Итого:** 16 единиц

**Исполнитель 4:**
- Задание G частично: 0 → 1 (остаток 1 единица)
- Задание H частично: 1 → 16 (15 из 16 единиц)
- **Итого:** 16 единиц

**Исполнитель 5:**
- Задание H частично: 0 → 1 (остаток 1 единица)
- **Итого:** 1 единица (простой: 1 → 16)

### Диаграмма Ганта

```mermaid
gantt
    title Диаграмма Ганта - Ленточная стратегия
    dateFormat s   
    axisFormat %S
    Начало выполнения работ : milestone, m1, 01 00:00, 0h
    section Исполнитель 1
    Задание A         :a1, 01 00:00, 4s
    Задание B         :a2, after a1, 6s
    Задание C         :a3, after a2, 5s
    Задание D         :a4, after a3, 1s
    section Исполнитель 2
    Задание D         :b1, 01 00:00, 5s
    Задание E         :b2, after b1, 8s
    Задание F         :b3, after b2, 3s
    section Исполнитель 3
    Задание F         :c1, 01 00:00, 6s
    Задание G         :c2, after c1, 10s
    section Исполнитель 4
    Задание G         :d1, 01 00:00, 1s
    Задание H         :d2, after d1, 15s
    section Исполнитель 5
    Задание H         :e1, 01 00:00, 1s
    Окончание выполнения работ : milestone, m2, 01 00:00:16, 0h
```

### Детальное распределение:

* **Исполнитель 1:** от 0 до 4 — задание A, от 4 до 10 — задание B, от 10 до 15 — задание C, от 15 до 16 — задание D (часть 1);
* **Исполнитель 2:** от 0 до 5 — задание D (часть 2), от 5 до 13 — задание E, от 13 до 16 — задание F (часть 1);
* **Исполнитель 3:** от 0 до 6 — задание F (часть 2), от 6 до 16 — задание G (часть 1);
* **Исполнитель 4:** от 0 до 1 — задание G (часть 2), от 1 до 16 — задание H (часть 1);
* **Исполнитель 5:** от 0 до 1 — задание H (часть 2);

**Итоговая длительность по ленточной стратегии: 16 единиц времени**

---

## Итоговые результаты

| Задача | Алгоритм | Длительность расписания (Makespan) |
|--------|----------|-----------------------------------|
| Задача 1 (Конвейерная) | Алгоритм Джонсона | **34 единицы** |
| Задача 2 (Ленточная стратегия) | Ленточная стратегия с прерываниями | **16 единиц** |

### Выводы:

1. **Алгоритм Джонсона** обеспечивает оптимальное решение для конвейерной задачи с двумя последовательными этапами, минимизируя общее время выполнения за счет правильного упорядочивания заданий.

2. **Ленточная стратегия** эффективно использует возможность прерывания заданий для равномерного распределения нагрузки между исполнителями, что позволяет достичь теоретически минимального времени выполнения.

3. В конвейерной задаче узким местом является необходимость последовательного выполнения этапов, что приводит к большему общему времени (34 единицы).

4. В ленточной стратегии параллельное выполнение и возможность прерываний позволяют завершить все задания значительно быстрее (16 единиц).